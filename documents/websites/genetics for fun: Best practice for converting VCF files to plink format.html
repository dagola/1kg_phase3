<!DOCTYPE html>
<html class='v2' dir='ltr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3213516723-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='http://apol1.blogspot.de/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="genetics for fun - Atom" href="http://apol1.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="genetics for fun - RSS" href="http://apol1.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="genetics for fun - Atom" href="https://www.blogger.com/feeds/2735750853096182491/posts/default" />

<link rel="alternate" type="application/atom+xml" title="genetics for fun - Atom" href="http://apol1.blogspot.com/feeds/368232205795617389/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/771816573-ieretrofit.js"></script>
<![endif]-->
<meta content='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html' property='og:url'/>
<meta content='Best practice for converting VCF files to plink format' property='og:title'/>
<meta content='Converting VCF files to plink format has never been easier. However, there are a few issues related to some intrinsic limitations of the pli...' property='og:description'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>genetics for fun: Best practice for converting VCF files to plink format</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */

/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #cccccc;
background: #292929 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #dd7700;
}
a:visited {
text-decoration:none;
color: #cc6600;
}
a:hover {
text-decoration:underline;
color: #cc6600;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #333333;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font-size: 140%;
color: #aaaaaa;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #404040;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #404040;
border-left: 0 solid #404040;
border-right: 0 solid #404040;
}
.tabs-inner .widget ul {
background: #222222 none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #404040;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #333333;
border-right: 0 solid #404040;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #ffffff;
background-color: #000000;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #404040;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #404040;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #404040;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #cccccc;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 0;
background: #111111;
border: 1px solid #111111;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 1px;
}
.post-body .tr-caption-container {
color: #cccccc;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #888888;
background-color: #303030;
border-bottom: 1px solid #444444;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #404040;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #111111;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #303030;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #404040;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #333333;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #333333;
}
.mobile-index-contents {
color: #cccccc;
}
.mobile-link-button {
background-color: #dd7700;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #000000;
color: #ffffff;
border-top: 1px solid #404040;
border-bottom: 1px solid #404040;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #404040;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2735750853096182491&amp;zx=5d8308d9-ccea-4bb9-ba5c-bbab77a1c539' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2735750853096182491&amp;zx=5d8308d9-ccea-4bb9-ba5c-bbab77a1c539' rel='stylesheet'/></noscript>
</head>
<body class='loading variant-dark'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d2735750853096182491\x26blogName\x3dgenetics+for+fun\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttp://apol1.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttp://apol1.blogspot.com/\x26targetPostID\x3d368232205795617389\x26blogPostOrPageUrl\x3dhttp://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html\x26vt\x3d8081545391195222418',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='http://apol1.blogspot.de/'>
genetics for fun
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Tuesday, November 25, 2014</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='2735750853096182491' itemprop='blogId'/>
<meta content='368232205795617389' itemprop='postId'/>
<a name='368232205795617389'></a>
<h3 class='post-title entry-title' itemprop='name'>
Best practice for converting VCF files to plink format
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-368232205795617389' itemprop='description articleBody'>
Converting VCF files to plink format has never been easier. However, there are a few issues related to some intrinsic limitations of the plink format. The first is related to the fact that variants in a plink file are bi-allelic only, while variants in a VCF file can be multi-allelic. The second is related to an intrinsic limitation of plink which makes indel definitions ambiguous. Here is an example: is the following variant an insertion or a deletion compared to the GRCh37 reference?<br />
<pre><code>
20 31022441</code> A AG</pre>
<br />
There is no way to tell, as the plink format does not record this information.<br />
<br />
Keeping this in mind, we are going to need two pieces of software for the conversion, bcftools and plink2. Here how to install them:<br />
<pre><code>
# create your personal binary directory
mkdir -p ~/bin/

# install latest version of bcftools
git clone --branch=develop git://github.com/samtools/bcftools.git
git clone --branch=develop git://github.com/samtools/htslib.git
cd htslib &amp;&amp; make &amp;&amp; cd ..
cd bcftools &amp;&amp; make &amp;&amp; cd ..
mv bcftools/bcftools ~/bin/

# install latest version of plink2
wget https://www.cog-genomics.org/static/bin/plink/plink_linux_x86_64.zip
unzip -od ~/bin/ plink_linux_x86_64.zip plink
</code></pre>
<br />
We are also going to need a copy of the GRCh37 reference. If you don't have this, it will take a while to download, but it can be done with the following commands:<br />
<pre><code>
wget -O- ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/human_g1k_v37.fasta.gz | gunzip &gt; human_g1k_v37.fasta
samtools faidx human_g1k_v37.fasta
</code></pre>
<br />
The following command will take the VCF file, strip the variant IDs, split multi-allelic sites into bi-allelic sites, assign names to make sure indels will not become ambiguous, and finally convert to plink format:<br />
<pre><code>
bcftools norm -Ou -m -any input.vcf.gz |
  bcftools norm -Ou -f human_g1k_v37.fasta |
  bcftools annotate -Ob -x ID \
    -I +'%CHROM:%POS:%REF:%ALT' |
  plink --bcf /dev/stdin \
    --keep-allele-order \
    --vcf-idspace-to _ \
    --const-fid \
    --allow-extra-chr 0 \
    --split-x b37 no-fail \
    --make-bed \
    --out output
</code></pre>
<br />
Usually dbSNP IDs are used for variants in VCF files, but in my opinion this is really a bad practice especially after splitting multi-allelic sites into bi-allelic sites (see <a href="http://annovar.openbioinformatics.org/en/latest/articles/dbSNP/">here</a> for a discussion).<br />
<br />
The first command will split multi-allelic alleles so that a variant like the following:<br />
<pre><code>
20 31022441 AG AGG,A
</code></pre>
<br />
Will become two variants as follows:<br />
<pre><code>
20 31022441 AG AGG
20 31022441 AG A
</code></pre>
<br />
The second command will make sure that after having been split, indels are normalized so to have a unique representation. The above multi-allelic variant would then become:<br />
<pre><code>
20 31022441 A AG
20 31022441 AG A
</code></pre>
<br />
Notice that plink will have a very hard time to distinguish between the two variants above, as they look alike once you forget which allele is the reference allele. The third command will assign a unique name to each bi-allelic variant:<br />
<pre><code>
20 31022441 20:31022441:A:AG A AG
20 31022441 20:31022441:AG:A AG A
</code></pre>
<br />
The fourth command will convert the final output to plink binary format. At this point, you will have a plink binary file with unique names for each variant. You can test that this is the case with the following command:<br />
<pre><code>
cut -f2 output.bim | sort | uniq -c | awk '$1&gt;1'
</code></pre>
<br />
If the above command returns any output, then you still have duplicate IDs but this means your VCF file must be flawed to begin with. Plink will not like having multiple variants with the same ID.<br />
<br />
You should now be able to use and to merge the file you have generated with other plink files generated from VCF files in the same way.<br />
<br />
Your last worry is individuals' sex, as the VCF format, contrary to plink format, does not encode this information. If your VCF file contains enough information about the X chromosome, you should be able to assign the sex straight from genotype. This is a command that might do the trick:<br />
<br />
<code></code><br />
<pre><code>plink --bfile output --impute-sex .3 .3 --make-bed --out output && rm output.{bed,bim,fam}~

</code></pre>
<br />
However, the two thresholds you should use (.3 .3 in the above example) to separate males from females are going to be dependent on the particular type of data you are using (e.g. exome or whole genome) and might have to be selected ad hoc. See <a href="https://www.cog-genomics.org/plink2/basic_stats#check_sex">here</a> for additional information.
<br />

A python wrapper to perform the above operations is available online (<a href="https://raw.githubusercontent.com/freeseek/gpipe/master/vcf2plink.py">here</a>).
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>freeseek</span>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html' itemprop='url'/>
<a class='timestamp-link' href='http://apol1.blogspot.de/2014/11/best-practice-for-converting-vcf-files.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2014-11-25T12:02:00-08:00'>12:02 PM</abbr></a>
</span>
<span class='reaction-buttons'>
</span>
<span class='post-comment-link'>
</span>
<span class='post-backlinks post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-320492652'>
<a href='https://www.blogger.com/post-edit.g?blogID=2735750853096182491&postID=368232205795617389&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=2735750853096182491&postID=368232205795617389&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=2735750853096182491&postID=368232205795617389&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=2735750853096182491&postID=368232205795617389&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=2735750853096182491&postID=368232205795617389&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=2735750853096182491&postID=368232205795617389&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a><div class='goog-inline-block google-plus-share-container'><g:plusone source='blogger:blog:plusone' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html' size='medium' width='300' annotation='inline'/></div>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>14 comments:</h4>
<div class='comments-content'>
<script async='async' src='//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = [{'id': '8059930100983192023', 'body': 'Thank you!! this is a great post freeseek! Incredibly needed nowadays!! \x3cbr /\x3eI have not been able to solve the error I get in the last lines of your code here:\x3cbr /\x3e\x3cbr /\x3ebcftools annotate -Ob -x ID chr21.test.vcf \x3cbr /\x3e\x3cbr /\x3ewhich says: \x3cbr /\x3e    [W::vcf_parse] INFO \x26#39;NS\x26#39; is not defined in the header, assuming Type\x3dString\x3cbr /\x3e    Encountered error, cannot proceed. Please check the error output above.\x3cbr /\x3e\x3cbr /\x3eIf you have any insight on how to go past this please let me know, thanks again!!', 'timestamp': '1418300075716', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1418300075716#c8059930100983192023', 'author': {'name': 'francy', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09952572613044920775'}, 'displayTime': 'December 11, 2014 at 4:14 AM', 'deleteclass': 'item-control blog-admin pid-1715953191'}, {'id': '565313252987617371', 'parentId': '8059930100983192023', 'body': 'It seems like your VCF file is malformed. You must have some \x26quot;NS\x3d...\x26quot; in the INFO field of one of the variants but without having NS defined in the header of the VCF file. I believe bcftools will refuse to work with malformed VCF files.', 'timestamp': '1418308951540', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1418308951540#c565313252987617371', 'author': {'name': 'freeseek', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13892797134951166637'}, 'displayTime': 'December 11, 2014 at 6:42 AM', 'deleteclass': 'item-control blog-admin pid-320492652'}, {'id': '6889091223780110255', 'body': 'Ok thanks... I downloaded it from the MACH website here: http://www.sph.umich.edu/csg/abecasis/MACH/download/1000G.2012-03-14.html   \x3cbr /\x3eMaybe this is an older version...?', 'timestamp': '1418315006984', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1418315006984#c6889091223780110255', 'author': {'name': 'francy', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09952572613044920775'}, 'displayTime': 'December 11, 2014 at 8:23 AM', 'deleteclass': 'item-control blog-admin pid-1715953191'}, {'id': '3105840296873094398', 'parentId': '6889091223780110255', 'body': 'Their VCF files are malformed. You should report this issue with the maintainers of those files (not here) as other people might have the same problem.', 'timestamp': '1418326612742', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1418326612742#c3105840296873094398', 'author': {'name': 'freeseek', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13892797134951166637'}, 'displayTime': 'December 11, 2014 at 11:36 AM', 'deleteclass': 'item-control blog-admin pid-320492652'}, {'id': '6749574730677475368', 'body': 'hi buddy i am getting this error\x3cbr /\x3e--bcf: 481k variants complete.Error: Excessively long typed string in .bcf file.', 'timestamp': '1456740753592', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1456740753592#c6749574730677475368', 'author': {'name': 'moin malik', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07725315193167985053'}, 'displayTime': 'February 29, 2016 at 2:12 AM', 'deleteclass': 'item-control blog-admin pid-1501514208'}, {'id': '1482406960623914139', 'body': 'Hi freeseek,\x3cbr /\x3e\x3cbr /\x3eThanks so much for the post.  I tried the pipelined command, and got an error, seemingly related to indels, and wondered if you could comment:\x3cbr /\x3e\x3cbr /\x3ebcftools norm -Ou -m -any exomes1.vcf.gz \x26gt; exomes1.norm.bcf\x3cbr /\x3eError: wrong number of fields in INFO/AF at 1:24180806, expected 2, found 3\x3cbr /\x3e\x3cbr /\x3ewith:\x3cbr /\x3e\x3cbr /\x3ebcftools view -H exomes1.vcf.gz 1:24180806 | cut -c 1-100\x3cbr /\x3e1 24180806 rs55699941 TA TAA,T 7970.41 PASS AC\x3d21,18;AF\x3d0.005,0.1238,0.1733;AN\x3d136;BaseQRankSum\x3d19.5\x3cbr /\x3e\x3cbr /\x3eClearly, the error message is legit -- this is a badly formatted line.  There are indeed 2 ALT alleles and 3 AF fields.  Any idea why one would see this discrepancy, and how to fix it?\x3cbr /\x3e\x3cbr /\x3eThanks,\x3cbr /\x3e\x3cbr /\x3eHenry\x3cbr /\x3e', 'timestamp': '1466621650597', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1466621650597#c1482406960623914139', 'author': {'name': 'Henry', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/11492361770873690362'}, 'displayTime': 'June 22, 2016 at 11:54 AM', 'deleteclass': 'item-control blog-admin pid-388230745'}, {'id': '4761597427677011320', 'body': 'I suppose you could change \x26quot;AF,Number\x3dA\x26quot; to \x26quot;AF,Number\x3d.\x26quot; in the header. A (slow)  way to do that could be: bcftools view exomes1.vcf.gz|sed \x26#39;s/AF,Number\x3dA/AF,Number\x3d./\x26#39;|bcftools norm -Ob -m -any -o exomes1.norm.bcf. But the correct thing to do here is to figure what software generated the VCF and report the bug upstream so that it gets fixed and other people don\x26#39;t have the same issue.', 'timestamp': '1466626756951', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1466626756951#c4761597427677011320', 'author': {'name': 'freeseek', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13892797134951166637'}, 'displayTime': 'June 22, 2016 at 1:19 PM', 'deleteclass': 'item-control blog-admin pid-320492652'}, {'id': '386382915531917823', 'parentId': '4761597427677011320', 'body': 'Thanks for the hack!  After further inspection, the simplest explanation is that the ALT field has two values but should have three.  This is clear from the fact that there are 4 AD values, 10 PL values, and 3 AF values.  Unfortunately the header isn\x26#39;t much help in tracing the origin of these files.  At least, this problem only occurs in indel type calls.  I\x26#39;m not very familiar with the VCF format or the various tools so it\x26#39;ll likely take me awhile to figure this out.  Anyway, thanks again for the help!', 'timestamp': '1466634990978', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1466634990978#c386382915531917823', 'author': {'name': 'Henry', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/11492361770873690362'}, 'displayTime': 'June 22, 2016 at 3:36 PM', 'deleteclass': 'item-control blog-admin pid-388230745'}, {'id': '8893934756642202153', 'body': 'Hi Giulio,\x3cbr /\x3e\x3cbr /\x3eI\x26#39;m working with a vcf file generated from the Beagle IBD software, it consists of the phased genotypes across 6 samples and all columns are identical to for example to the 1000Genomes phased genotype vcfs. Though when I run the: \x3cbr /\x3e\x3cbr /\x3e\x26quot;~/bin/bcftools norm -Ou -m -any phased_fbp.vcf.gz | ~/bin/bcftools norm -Ou -f /stornext/snfs5/ruichen/dmhg/fgi/evanj/PCA_Data/1KG/human_g1k_v37.fasta | ~/bin/bcftools annotate -Ob -x ID -I +\x26#39;%CHROM:%POS:%REF:%ALT\x26#39; | ~/bin/plink --bcf /dev/stdin --keep-allele-order --vcf-idspace-to _ --const-fid --allow-extra-chr 0 --split-x b37 no-fail --make-bed --out fbp\x26quot; command \x3cbr /\x3e\x3cbr /\x3eI get a error saying my .bcf file is improperly formatted:\x3cbr /\x3e###############\x3cbr /\x3ePLINK v1.90b3.42 64-bit (20 Sep 2016)      https://www.cog-genomics.org/plink2\x3cbr /\x3e(C) 2005-2016 Shaun Purcell, Christopher Chang   GNU General Public License v3\x3cbr /\x3eLogging to fbp.log.\x3cbr /\x3eOptions in effect:\x3cbr /\x3e  --allow-extra-chr 0\x3cbr /\x3e  --bcf /dev/stdin\x3cbr /\x3e  --const-fid\x3cbr /\x3e  --keep-allele-order\x3cbr /\x3e  --make-bed\x3cbr /\x3e  --out fbp\x3cbr /\x3e  --split-x b37 no-fail\x3cbr /\x3e  --vcf-idspace-to _\x3cbr /\x3e\x3cbr /\x3e7872 MB RAM detected; reserving 3936 MB for main workspace.\x3cbr /\x3eReference allele mismatch at 1:752566 .. REF_SEQ:\x26#39;G\x26#39; vs VCF:\x26#39;A\x26#39;\x3cbr /\x3eFailed to open -: unknown file type\x3cbr /\x3eError: Improperly formatted .bcf file.\x3cbr /\x3e##########\x3cbr /\x3eAny idea on what I may have wrong? Does this mean my vcf file is somehow improperly formatted? Thanks', 'timestamp': '1476317238826', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1476317238826#c8893934756642202153', 'author': {'name': 'Evan Jones', 'avatarUrl': '//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/09165854716471034275'}, 'displayTime': 'October 12, 2016 at 5:07 PM', 'deleteclass': 'item-control blog-admin pid-1906419903'}, {'id': '3679498007216980571', 'parentId': '8893934756642202153', 'body': '\x3cspan class\x3d\x27deleted-comment\x27\x3eThis comment has been removed by the author.\x3c/span\x3e', 'timestamp': '1476317958352', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1476317958352#c3679498007216980571', 'author': {'name': 'Evan Jones', 'avatarUrl': '//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/09165854716471034275'}, 'displayTime': 'October 12, 2016 at 5:19 PM', 'deleteclass': 'item-control blog-admin '}, {'id': '2771904084906895234', 'parentId': '8893934756642202153', 'body': '##fileformat\x3dVCFv4.2\x3cbr /\x3e##filedate\x3d20160822\x3cbr /\x3e##source\x3d\x26quot;beagle.27Jul16.86a.jar (version 4.1)\x26quot;\x3cbr /\x3e##INFO\x3d\x3cbr /\x3e##INFO\x3d\x3cbr /\x3e##INFO\x3d\x3cbr /\x3e##INFO\x3d\x3cbr /\x3e##FORMAT\x3d\x3cbr /\x3e##FORMAT\x3d\x3cbr /\x3e##FORMAT\x3d\x3cbr /\x3e#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  southAmerica_BR91       southAmerica_BR96       southAmerica_BR128      southAmerica_FBP500     southAmerica_FBP428     southAmerica_FBP335\x3cbr /\x3e1       752566  rs3094315       A       G       .       PASS    .       GT      1|0     0|0     0|0     0|0     1|0     0|0\x3cbr /\x3e1       752721  rs3131972       G       A       .       PASS    .       GT      1|0     0|0     1|0     0|0     1|0     0|0\x3cbr /\x3e1       762320  exm2268640      G       A       .       PASS    .       GT      0|0     0|0     1|0     0|0     0|0     0|0\x3cbr /\x3e1       798959  rs11240777      G       A       .       PASS    .       GT      1|1     0|0     0|1     0|1     1|0     0|0\x3cbr /\x3e1       838555  rs4970383       C       A       .       PASS    .       GT      0|0     1|0     0|0     0|0     0|1     1|1', 'timestamp': '1476318065338', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1476318065338#c2771904084906895234', 'author': {'name': 'Evan Jones', 'avatarUrl': '//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/09165854716471034275'}, 'displayTime': 'October 12, 2016 at 5:21 PM', 'deleteclass': 'item-control blog-admin pid-1906419903'}, {'id': '1591786318752982665', 'body': 'Evan, your VCF file is malformed. At position chr1:752,566 you have the reference allele as letter A, but in the /stornext/snfs5/ruichen/dmhg/fgi/evanj/PCA_Data/1KG/human_g1k_v37.fasta file you have the letter G at the same position. The bcftools norm command cannot run with such inconsistencies. Somehow you messed up the reference/alternate allele when you generated the VCF file. Malformed VCF files are not going to work. Use bcftools norm --check-ref to verify whether the VCF file is properly formatted with respect to the reference genome.', 'timestamp': '1476369378136', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1476369378136#c1591786318752982665', 'author': {'name': 'freeseek', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13892797134951166637'}, 'displayTime': 'October 13, 2016 at 7:36 AM', 'deleteclass': 'item-control blog-admin pid-320492652'}, {'id': '4790598781873355583', 'body': 'Hi freeseek, \x3cbr /\x3eI am using the same files as you have used. But , bcftools norm -Ou -m -any input.vcf.gz |\x3cbr /\x3e  bcftools norm -Ou -f human_g1k_v37.fasta |\x3cbr /\x3e  bcftools annotate -Ob -x ID \\\x3cbr /\x3e    -I +\x26#39;%CHROM:%POS:%REF:%ALT\x26#39; |\x3cbr /\x3e  plink --bcf /dev/stdin \\\x3cbr /\x3e    --keep-allele-order \\\x3cbr /\x3e    --vcf-idspace-to _ \\\x3cbr /\x3e    --const-fid \\\x3cbr /\x3e    --allow-extra-chr 0 \\\x3cbr /\x3e    --split-x b37 no-fail \\\x3cbr /\x3e    --make-bed \\\x3cbr /\x3e    --out output\x3cbr /\x3e\x3cbr /\x3eDoesn\x26#39;t work for me and I get the error : Improperly formatted bcf. I am new to genomics and I find difficult to get the principal components for 1000 genomes', 'timestamp': '1504604556085', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1504604556085#c4790598781873355583', 'author': {'name': 'Aadhira', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07110977164188577108'}, 'displayTime': 'September 5, 2017 at 2:42 AM', 'deleteclass': 'item-control blog-admin pid-28092412'}, {'id': '6163019460026008368', 'body': 'It seems like your BCF file is malformed. I advise you to discuss your problem with the person that gave you the file. Another good way to start is to get familiar with \x26quot;bcftools norm --check-ref\x26quot; to make sure your VCF file is good. I have seen many examples of VCF files not following the standard.', 'timestamp': '1504624497882', 'permalink': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment\x3d1504624497882#c6163019460026008368', 'author': {'name': 'freeseek', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13892797134951166637'}, 'displayTime': 'September 5, 2017 at 8:14 AM', 'deleteclass': 'item-control blog-admin pid-320492652'}];
      var msgs = {'loadMore': 'Load more...', 'loading': 'Loading...', 'loaded': 'No more!', 'addComment': 'Add comment', 'reply': 'Reply', 'delete': 'Delete'};
      var config = {'blogId': '2735750853096182491', 'postId': '368232205795617389', 'feed': 'http://apol1.blogspot.com/feeds/368232205795617389/comments/default', 'authorName': 'freeseek', 'authorUrl': 'https://www.blogger.com/profile/13892797134951166637', 'baseUri': 'https://www.blogger.com', 'maxThreadDepth': 2};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        if (entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + entry.content.$t + '</span>';
            }
          }
        }
        return entry.content.$t;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id='comment-holder'>
<div id='bc_0_15C' kind='c'><div id='bc_0_15CT'><div id='bc_0_14T' class='comment-thread' kind='r'  t='0' u='0'><ol id='bc_0_14TB'><li id='bc_0_1B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c8059930100983192023' class='comment-block'><div id='bc_0_1M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/09952572613044920775'>francy</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1418300075716#c8059930100983192023'>December 11, 2014 at 4:14 AM</a></span></div><p id='bc_0_1MC' class='comment-content'>Thank you!! this is a great post freeseek! Incredibly needed nowadays!! <br />I have not been able to solve the error I get in the last lines of your code here:<br /><br />bcftools annotate -Ob -x ID chr21.test.vcf <br /><br />which says: <br />    [W::vcf_parse] INFO &#39;NS&#39; is not defined in the header, assuming Type=String<br />    Encountered error, cannot proceed. Please check the error output above.<br /><br />If you have any insight on how to go past this please let me know, thanks again!!</p><span id='bc_0_1MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-1715953191'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=8059930100983192023'>Delete</a></span></span></div><div id='bc_0_1BR' class='comment-replies'><span id='bc_0_1b+seedDMPsD' kind='d'><div id='bc_0_0T' class='comment-thread inline-thread' kind='t'   t='0' u='0'><span id='bc_0_0TT' class='thread-toggle thread-expanded' kind='g'><span id='bc_0_0TA' class='thread-arrow'></span><span id='bc_0_0TN' class='thread-count'><span id='bc_0_0TNT' style='display: none;'></span><span id='bc_0_0TNU' style='display: none;'></span><a href='javascript:;' target='_self'>Replies</a><div id='bc_0_0TD' class='thread-dropContainer thread-expanded'><span class='thread-drop'></span></div></span></span><ol id='bc_0_0TC' class='thread-chrome thread-expanded'><div><li id='bc_0_0B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c565313252987617371' class='comment-block'><div id='bc_0_0M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='https://www.blogger.com/profile/13892797134951166637'>freeseek</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1418308951540#c565313252987617371'>December 11, 2014 at 6:42 AM</a></span></div><p id='bc_0_0MC' class='comment-content'>It seems like your VCF file is malformed. You must have some &quot;NS=...&quot; in the INFO field of one of the variants but without having NS defined in the header of the VCF file. I believe bcftools will refuse to work with malformed VCF files.</p><span id='bc_0_0MN' class='comment-actions secondary-text' kind='m'><span class='item-control blog-admin pid-320492652'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=565313252987617371'>Delete</a></span></span></div><div id='bc_0_0BR' class='comment-replies'></div><div id='bc_0_0B_box' class='comment-replybox-single'></div></li></div><div id='bc_0_0I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Reply</a></div></ol><div id='bc_0_0T_box' class='comment-replybox-thread'></div></div></span></div><div id='bc_0_1B_box' class='comment-replybox-single'></div></li><li id='bc_0_3B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c6889091223780110255' class='comment-block'><div id='bc_0_3M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/09952572613044920775'>francy</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1418315006984#c6889091223780110255'>December 11, 2014 at 8:23 AM</a></span></div><p id='bc_0_3MC' class='comment-content'>Ok thanks... I downloaded it from the MACH website here: http://www.sph.umich.edu/csg/abecasis/MACH/download/1000G.2012-03-14.html   <br />Maybe this is an older version...?</p><span id='bc_0_3MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-1715953191'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=6889091223780110255'>Delete</a></span></span></div><div id='bc_0_3BR' class='comment-replies'><span id='bc_0_3b+seedDMPuD' kind='d'><div id='bc_0_2T' class='comment-thread inline-thread' kind='t'   t='0' u='0'><span id='bc_0_2TT' class='thread-toggle thread-expanded' kind='g'><span id='bc_0_2TA' class='thread-arrow'></span><span id='bc_0_2TN' class='thread-count'><span id='bc_0_2TNT' style='display: none;'></span><span id='bc_0_2TNU' style='display: none;'></span><a href='javascript:;' target='_self'>Replies</a><div id='bc_0_2TD' class='thread-dropContainer thread-expanded'><span class='thread-drop'></span></div></span></span><ol id='bc_0_2TC' class='thread-chrome thread-expanded'><div><li id='bc_0_2B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c3105840296873094398' class='comment-block'><div id='bc_0_2M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='https://www.blogger.com/profile/13892797134951166637'>freeseek</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1418326612742#c3105840296873094398'>December 11, 2014 at 11:36 AM</a></span></div><p id='bc_0_2MC' class='comment-content'>Their VCF files are malformed. You should report this issue with the maintainers of those files (not here) as other people might have the same problem.</p><span id='bc_0_2MN' class='comment-actions secondary-text' kind='m'><span class='item-control blog-admin pid-320492652'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=3105840296873094398'>Delete</a></span></span></div><div id='bc_0_2BR' class='comment-replies'></div><div id='bc_0_2B_box' class='comment-replybox-single'></div></li></div><div id='bc_0_2I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Reply</a></div></ol><div id='bc_0_2T_box' class='comment-replybox-thread'></div></div></span></div><div id='bc_0_3B_box' class='comment-replybox-single'></div></li><li id='bc_0_4B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c6749574730677475368' class='comment-block'><div id='bc_0_4M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/07725315193167985053'>moin malik</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1456740753592#c6749574730677475368'>February 29, 2016 at 2:12 AM</a></span></div><p id='bc_0_4MC' class='comment-content'>hi buddy i am getting this error<br />--bcf: 481k variants complete.Error: Excessively long typed string in .bcf file.</p><span id='bc_0_4MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-1501514208'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=6749574730677475368'>Delete</a></span></span></div><div id='bc_0_4BR' class='comment-replies'></div><div id='bc_0_4B_box' class='comment-replybox-single'></div></li><li id='bc_0_5B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c1482406960623914139' class='comment-block'><div id='bc_0_5M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/11492361770873690362'>Henry</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1466621650597#c1482406960623914139'>June 22, 2016 at 11:54 AM</a></span></div><p id='bc_0_5MC' class='comment-content'>Hi freeseek,<br /><br />Thanks so much for the post.  I tried the pipelined command, and got an error, seemingly related to indels, and wondered if you could comment:<br /><br />bcftools norm -Ou -m -any exomes1.vcf.gz &gt; exomes1.norm.bcf<br />Error: wrong number of fields in INFO/AF at 1:24180806, expected 2, found 3<br /><br />with:<br /><br />bcftools view -H exomes1.vcf.gz 1:24180806 | cut -c 1-100<br />1 24180806 rs55699941 TA TAA,T 7970.41 PASS AC=21,18;AF=0.005,0.1238,0.1733;AN=136;BaseQRankSum=19.5<br /><br />Clearly, the error message is legit -- this is a badly formatted line.  There are indeed 2 ALT alleles and 3 AF fields.  Any idea why one would see this discrepancy, and how to fix it?<br /><br />Thanks,<br /><br />Henry<br /></p><span id='bc_0_5MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-388230745'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=1482406960623914139'>Delete</a></span></span></div><div id='bc_0_5BR' class='comment-replies'></div><div id='bc_0_5B_box' class='comment-replybox-single'></div></li><li id='bc_0_7B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c4761597427677011320' class='comment-block'><div id='bc_0_7M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='https://www.blogger.com/profile/13892797134951166637'>freeseek</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1466626756951#c4761597427677011320'>June 22, 2016 at 1:19 PM</a></span></div><p id='bc_0_7MC' class='comment-content'>I suppose you could change &quot;AF,Number=A&quot; to &quot;AF,Number=.&quot; in the header. A (slow)  way to do that could be: bcftools view exomes1.vcf.gz|sed &#39;s/AF,Number=A/AF,Number=./&#39;|bcftools norm -Ob -m -any -o exomes1.norm.bcf. But the correct thing to do here is to figure what software generated the VCF and report the bug upstream so that it gets fixed and other people don&#39;t have the same issue.</p><span id='bc_0_7MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-320492652'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=4761597427677011320'>Delete</a></span></span></div><div id='bc_0_7BR' class='comment-replies'><span id='bc_0_7b+seedDMPyD' kind='d'><div id='bc_0_6T' class='comment-thread inline-thread' kind='t'   t='0' u='0'><span id='bc_0_6TT' class='thread-toggle thread-expanded' kind='g'><span id='bc_0_6TA' class='thread-arrow'></span><span id='bc_0_6TN' class='thread-count'><span id='bc_0_6TNT' style='display: none;'></span><span id='bc_0_6TNU' style='display: none;'></span><a href='javascript:;' target='_self'>Replies</a><div id='bc_0_6TD' class='thread-dropContainer thread-expanded'><span class='thread-drop'></span></div></span></span><ol id='bc_0_6TC' class='thread-chrome thread-expanded'><div><li id='bc_0_6B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c386382915531917823' class='comment-block'><div id='bc_0_6M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/11492361770873690362'>Henry</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1466634990978#c386382915531917823'>June 22, 2016 at 3:36 PM</a></span></div><p id='bc_0_6MC' class='comment-content'>Thanks for the hack!  After further inspection, the simplest explanation is that the ALT field has two values but should have three.  This is clear from the fact that there are 4 AD values, 10 PL values, and 3 AF values.  Unfortunately the header isn&#39;t much help in tracing the origin of these files.  At least, this problem only occurs in indel type calls.  I&#39;m not very familiar with the VCF format or the various tools so it&#39;ll likely take me awhile to figure this out.  Anyway, thanks again for the help!</p><span id='bc_0_6MN' class='comment-actions secondary-text' kind='m'><span class='item-control blog-admin pid-388230745'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=386382915531917823'>Delete</a></span></span></div><div id='bc_0_6BR' class='comment-replies'></div><div id='bc_0_6B_box' class='comment-replybox-single'></div></li></div><div id='bc_0_6I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Reply</a></div></ol><div id='bc_0_6T_box' class='comment-replybox-thread'></div></div></span></div><div id='bc_0_7B_box' class='comment-replybox-single'></div></li><li id='bc_0_10B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg'></img></div><div id='c8893934756642202153' class='comment-block'><div id='bc_0_10M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/09165854716471034275'>Evan Jones</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1476317238826#c8893934756642202153'>October 12, 2016 at 5:07 PM</a></span></div><p id='bc_0_10MC' class='comment-content'>Hi Giulio,<br /><br />I&#39;m working with a vcf file generated from the Beagle IBD software, it consists of the phased genotypes across 6 samples and all columns are identical to for example to the 1000Genomes phased genotype vcfs. Though when I run the: <br /><br />&quot;~/bin/bcftools norm -Ou -m -any phased_fbp.vcf.gz | ~/bin/bcftools norm -Ou -f /stornext/snfs5/ruichen/dmhg/fgi/evanj/PCA_Data/1KG/human_g1k_v37.fasta | ~/bin/bcftools annotate -Ob -x ID -I +&#39;%CHROM:%POS:%REF:%ALT&#39; | ~/bin/plink --bcf /dev/stdin --keep-allele-order --vcf-idspace-to _ --const-fid --allow-extra-chr 0 --split-x b37 no-fail --make-bed --out fbp&quot; command <br /><br />I get a error saying my .bcf file is improperly formatted:<br />###############<br />PLINK v1.90b3.42 64-bit (20 Sep 2016)      https://www.cog-genomics.org/plink2<br />(C) 2005-2016 Shaun Purcell, Christopher Chang   GNU General Public License v3<br />Logging to fbp.log.<br />Options in effect:<br />  --allow-extra-chr 0<br />  --bcf /dev/stdin<br />  --const-fid<br />  --keep-allele-order<br />  --make-bed<br />  --out fbp<br />  --split-x b37 no-fail<br />  --vcf-idspace-to _<br /><br />7872 MB RAM detected; reserving 3936 MB for main workspace.<br />Reference allele mismatch at 1:752566 .. REF_SEQ:&#39;G&#39; vs VCF:&#39;A&#39;<br />Failed to open -: unknown file type<br />Error: Improperly formatted .bcf file.<br />##########<br />Any idea on what I may have wrong? Does this mean my vcf file is somehow improperly formatted? Thanks</p><span id='bc_0_10MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-1906419903'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=8893934756642202153'>Delete</a></span></span></div><div id='bc_0_10BR' class='comment-replies'><span id='bc_0_10b+seedDMP0D' kind='d'><div id='bc_0_8T' class='comment-thread inline-thread' kind='t'   t='0' u='0'><span id='bc_0_8TT' class='thread-toggle thread-expanded' kind='g'><span id='bc_0_8TA' class='thread-arrow'></span><span id='bc_0_8TN' class='thread-count'><span id='bc_0_8TNT' style='display: none;'></span><span id='bc_0_8TNU' style='display: none;'></span><a href='javascript:;' target='_self'>Replies</a><div id='bc_0_8TD' class='thread-dropContainer thread-expanded'><span class='thread-drop'></span></div></span></span><ol id='bc_0_8TC' class='thread-chrome thread-expanded'><div><li id='bc_0_8B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg'></img></div><div id='c3679498007216980571' class='comment-block'><div id='bc_0_8M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/09165854716471034275'>Evan Jones</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1476317958352#c3679498007216980571'>October 12, 2016 at 5:19 PM</a></span></div><p id='bc_0_8MC' class='comment-content'><span class='deleted-comment'>This comment has been removed by the author.</span></p><span id='bc_0_8MN' class='comment-actions secondary-text' kind='m'><span class='item-control blog-admin '><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=3679498007216980571'>Delete</a></span></span></div><div id='bc_0_8BR' class='comment-replies'></div><div id='bc_0_8B_box' class='comment-replybox-single'></div></li><li id='bc_0_9B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh6.googleusercontent.com/-h7XZ2vlSSRg/AAAAAAAAAAI/AAAAAAAAAFY/fuEpnWsgYgY/s35-c/photo.jpg'></img></div><div id='c2771904084906895234' class='comment-block'><div id='bc_0_9M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/09165854716471034275'>Evan Jones</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1476318065338#c2771904084906895234'>October 12, 2016 at 5:21 PM</a></span></div><p id='bc_0_9MC' class='comment-content'>##fileformat=VCFv4.2<br />##filedate=20160822<br />##source=&quot;beagle.27Jul16.86a.jar (version 4.1)&quot;<br />##INFO=<br />##INFO=<br />##INFO=<br />##INFO=<br />##FORMAT=<br />##FORMAT=<br />##FORMAT=<br />#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  southAmerica_BR91       southAmerica_BR96       southAmerica_BR128      southAmerica_FBP500     southAmerica_FBP428     southAmerica_FBP335<br />1       752566  rs3094315       A       G       .       PASS    .       GT      1|0     0|0     0|0     0|0     1|0     0|0<br />1       752721  rs3131972       G       A       .       PASS    .       GT      1|0     0|0     1|0     0|0     1|0     0|0<br />1       762320  exm2268640      G       A       .       PASS    .       GT      0|0     0|0     1|0     0|0     0|0     0|0<br />1       798959  rs11240777      G       A       .       PASS    .       GT      1|1     0|0     0|1     0|1     1|0     0|0<br />1       838555  rs4970383       C       A       .       PASS    .       GT      0|0     1|0     0|0     0|0     0|1     1|1</p><span id='bc_0_9MN' class='comment-actions secondary-text' kind='m'><span class='item-control blog-admin pid-1906419903'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=2771904084906895234'>Delete</a></span></span></div><div id='bc_0_9BR' class='comment-replies'></div><div id='bc_0_9B_box' class='comment-replybox-single'></div></li></div><div id='bc_0_8I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Reply</a></div></ol><div id='bc_0_8T_box' class='comment-replybox-thread'></div></div></span></div><div id='bc_0_10B_box' class='comment-replybox-single'></div></li><li id='bc_0_11B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c1591786318752982665' class='comment-block'><div id='bc_0_11M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='https://www.blogger.com/profile/13892797134951166637'>freeseek</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1476369378136#c1591786318752982665'>October 13, 2016 at 7:36 AM</a></span></div><p id='bc_0_11MC' class='comment-content'>Evan, your VCF file is malformed. At position chr1:752,566 you have the reference allele as letter A, but in the /stornext/snfs5/ruichen/dmhg/fgi/evanj/PCA_Data/1KG/human_g1k_v37.fasta file you have the letter G at the same position. The bcftools norm command cannot run with such inconsistencies. Somehow you messed up the reference/alternate allele when you generated the VCF file. Malformed VCF files are not going to work. Use bcftools norm --check-ref to verify whether the VCF file is properly formatted with respect to the reference genome.</p><span id='bc_0_11MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-320492652'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=1591786318752982665'>Delete</a></span></span></div><div id='bc_0_11BR' class='comment-replies'></div><div id='bc_0_11B_box' class='comment-replybox-single'></div></li><li id='bc_0_12B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c4790598781873355583' class='comment-block'><div id='bc_0_12M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='https://www.blogger.com/profile/07110977164188577108'>Aadhira</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1504604556085#c4790598781873355583'>September 5, 2017 at 2:42 AM</a></span></div><p id='bc_0_12MC' class='comment-content'>Hi freeseek, <br />I am using the same files as you have used. But , bcftools norm -Ou -m -any input.vcf.gz |<br />  bcftools norm -Ou -f human_g1k_v37.fasta |<br />  bcftools annotate -Ob -x ID \<br />    -I +&#39;%CHROM:%POS:%REF:%ALT&#39; |<br />  plink --bcf /dev/stdin \<br />    --keep-allele-order \<br />    --vcf-idspace-to _ \<br />    --const-fid \<br />    --allow-extra-chr 0 \<br />    --split-x b37 no-fail \<br />    --make-bed \<br />    --out output<br /><br />Doesn&#39;t work for me and I get the error : Improperly formatted bcf. I am new to genomics and I find difficult to get the principal components for 1000 genomes</p><span id='bc_0_12MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-28092412'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=4790598781873355583'>Delete</a></span></span></div><div id='bc_0_12BR' class='comment-replies'></div><div id='bc_0_12B_box' class='comment-replybox-single'></div></li><li id='bc_0_13B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'></img></div><div id='c6163019460026008368' class='comment-block'><div id='bc_0_13M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='https://www.blogger.com/profile/13892797134951166637'>freeseek</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html?showComment=1504624497882#c6163019460026008368'>September 5, 2017 at 8:14 AM</a></span></div><p id='bc_0_13MC' class='comment-content'>It seems like your BCF file is malformed. I advise you to discuss your problem with the person that gave you the file. Another good way to start is to get familiar with &quot;bcftools norm --check-ref&quot; to make sure your VCF file is good. I have seen many examples of VCF files not following the standard.</p><span id='bc_0_13MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-320492652'><a o='d' target='_self' href='https://www.blogger.com/delete-comment.g?blogID=2735750853096182491&amp;postID=6163019460026008368'>Delete</a></span></span></div><div id='bc_0_13BR' class='comment-replies'></div><div id='bc_0_13B_box' class='comment-replybox-single'></div></li></ol><div id='bc_0_14I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Add comment</a></div><div id='bc_0_14T_box' class='comment-replybox-thread'></div><div id='bc_0_14L' class='loadmore loaded' kind='rb'><a href='javascript:;' target='_self'>Load more...</a></div></div></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment-iframe.g?blogID=2735750853096182491&postID=368232205795617389' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2244480862-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='http://apol1.blogspot.de/2015/05/annotate-cpg-mutations-in-vcf-file.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://apol1.blogspot.de/2014/05/how-do-i-identify-all-homopolymer-run.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='http://apol1.blogspot.de/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='http://apol1.blogspot.com/feeds/368232205795617389/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
<script type='text/javascript'>
    window.___gcfg = { 'lang': 'en' };
  </script>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2016/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2015/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2014/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='http://apol1.blogspot.de/2014/11/best-practice-for-converting-vcf-files.html'>Best practice for converting VCF files to plink fo...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2014/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2013/'>
2013
</a>
<span class='post-count' dir='ltr'>(8)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2013/12/'>
December
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2013/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2013/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://apol1.blogspot.de/2013/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=2735750853096182491&widgetType=BlogArchive&widgetId=BlogArchive1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Simple theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=2735750853096182491&widgetType=Attribution&widgetId=Attribution1&action=editWidget&sectionId=footer-3' onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' target='configAttribution1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>
<!--Es liegt in deiner Verantwortung, deine Besucher \xfcber die in deinem Blog verwendeten Cookies zu informieren. Weitere Informationen findest du hier http://www.blogger.com/go/cookiechoices.-->
<script defer='' src='/js/cookiechoices.js'></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'Diese Website verwendet Cookies von Google, um ihre Dienste bereitzustellen, Anzeigen zu personalisieren und Zugriffe zu analysieren. Informationen dar\xfcber, wie du die Website verwendest, werden an Google weitergegeben. Durch die Nutzung dieser Website erkl\xe4rst du dich damit einverstanden, dass sie Cookies verwendet.',
          (window.cookieOptions && cookieOptions.close) || 'OK',
          (window.cookieOptions && cookieOptions.learn) || 'Weitere Informationen',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/4187781524-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7vnGF5wXJ4Sh0V7vY3XX_9ukonOQ:1514908025774';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d2735750853096182491','//apol1.blogspot.de/2014/11/best-practice-for-converting-vcf-files.html','2735750853096182491');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '2735750853096182491', 'title': 'genetics for fun', 'url': 'http://apol1.blogspot.de/2014/11/best-practice-for-converting-vcf-files.html', 'canonicalUrl': 'http://apol1.blogspot.com/2014/11/best-practice-for-converting-vcf-files.html', 'homepageUrl': 'http://apol1.blogspot.de/', 'searchUrl': 'http://apol1.blogspot.de/search', 'canonicalHomepageUrl': 'http://apol1.blogspot.com/', 'blogspotFaviconUrl': 'http://apol1.blogspot.de/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22genetics for fun - Atom\x22 href\x3d\x22http://apol1.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22genetics for fun - RSS\x22 href\x3d\x22http://apol1.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22genetics for fun - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/2735750853096182491/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22genetics for fun - Atom\x22 href\x3d\x22http://apol1.blogspot.com/feeds/368232205795617389/comments/default\x22 /\x3e\n', 'meTag': '', 'openIdOpTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/771816573-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/1b31bc7f845d8a75', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Google+', 'key': 'googlePlus', 'shareMessage': 'Share to Google+', 'target': 'googleplus'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '368232205795617389', 'pageName': 'Best practice for converting VCF files to plink format', 'pageTitle': 'genetics for fun: Best practice for converting VCF files to plink format'}}, {'name': 'features', 'data': {'lazy_images': 'false', 'unsupported_browser_message': 'false', 'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'dark', 'variantId': 'dark'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Best practice for converting VCF files to plink format', 'description': 'Converting VCF files to plink format has never been easier. However, there are a few issues related to some intrinsic limitations of the pli...', 'url': 'http://apol1.blogspot.de/2014/11/best-practice-for-converting-vcf-files.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 368232205795617389}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'useNgc': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3237050349-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/368954415-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', null, document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>